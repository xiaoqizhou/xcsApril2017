%CS 109 Problem Set Xiaoqi Zhou


\documentclass{article}
	% basic article document class
	% use percent signs to make comments to yourself -- they will not show up.

\usepackage{amsmath}
\usepackage{amssymb}
	% packages that allow mathematical formatting

\usepackage{graphicx}
\usepackage{float}
	% package that allows you to include graphics

\usepackage[top=1in, bottom=1in, left=1in, right=1in]{geometry}

\frenchspacing
	% one space after periods

\usepackage{fancyhdr}
	% allows custom headers

\pagestyle{fancy}

\lhead{CS 109, Stanford University \\ Problem Set \#4} 
\rhead{Xiaoqi Zhou (xqzhou@stanford.edu) \\ 06237147}
\usepackage{color}
\usepackage{courier}
\usepackage{relsize}
\cfoot{\thepage}
\renewcommand{\footrulewidth}{0.4pt} 
	%footer
\newcommand{\myansw}{\textbf{Answer:}\\}
\newcommand{\mysolu}{\textbf{Solution:}\\}
\begin{document}
\thispagestyle{fancy} %shows header/footer

\begin{enumerate}
	\item
	%1
	\begin{enumerate}
		\item
		\mysolu
		The number of users should be a poisson distribution which is\\
		${X \sim Poi(\lambda)}$ where ${\lambda = 5.5}$\\
		The probability that more than 7 users will sign-up for the social networking site in the next miniute is\\
		${P(E) = 1 - P(E^c) = 1 - P\{X \leq 7\} = 1 - \sum\limits_{i = 0}^7 \frac{e^{-5.5}5.5^i}{i!}}$\\
		\myansw
		We can also use normal distribution to approximate the probability\\
		\colorbox{yellow}{${P\{X > 7\} = 1 - \Phi(\frac{7-5.5}{\sqrt{5.5}}) = 1 - 0.7389 = 0.2611 }$}\\
		
		\item
		\myansw
		The probability that more than 13 users will sign-up for the social networking site in the next 2 minute is\\
		\colorbox{yellow}{${P\{X > 13\} = 1 - P\{X \leq 13\} = 1 - \Phi(\frac{13 - 5.5\times2}{\sqrt{5.5 \times 2}}) = 1 - 0.7257 = 0.2743}$}\\
		
		\item
		\myansw
		The probability that more than 15 users will sign-up for the social networking site in the next 3 minute is\\
		\colorbox{yellow}{${P\{X > 15\} = 1 - P\{X \leq 15\} = 1 - \Phi(\frac{15 - 5.5\times3}{\sqrt{5.5 \times 3}}) = \Phi(0.3693) = 0.6433}$}\\		
		
	\end{enumerate}
	\item 
	%2
	\begin{enumerate}
		\item
		\mysolu
		${\mathlarger{\int_{0}^{1}{\int_{0}^{x}}c\frac{y}{x}dydx}=\mathlarger{\int_{0}^{1}\frac{1}{2}c\frac{x^2}{x}dx=\frac{1}{4}cx^2\big|_{0}^{1}}=\frac{1}{4}c=1}$\\
		\myansw
		\colorbox{yellow}{${c = 4}$}\\
		
		\item
		\mysolu
		${f_X(x) = \mathlarger{\int_{0}^{x}4\frac{y}{x}dy}=\mathlarger{2c\frac{y^2}{x}\big|_{0}^{x}}=2x}$\\
		${f_Y(y) = \mathlarger{\int_{y}^{1}4\frac{y}{x}dx}=\mathlarger{cy\ln(x)\big|_{y}^{1}}=-4y\ln(y)}$\\
		${f_{XY}(x,y) \neq f_X(x)f_Y(y)}$\\
		\myansw
		\colorbox{yellow}{X and Y are not independent}\\
		\item
		\myansw
		\colorbox{yellow}{${f_X(x) =2x}$ }\\
		\item
		\myansw
		\colorbox{yellow}{${f_Y(y) =-4y\ln(y)}$ }\\
		\item
		\myansw
		\colorbox{yellow}{${E[X] = \mathlarger{\int_{0}^{1}2x^2dx}=\frac{2}{3}x^3\big|_{0}^{1}=\frac{2}{3}}$}\\
		\item
		\myansw
		${E[Y] = \mathlarger{\int_{0}^{1}-4y^2\ln(y)dy=-4(\ln(y)\int_{0}^{1}y^2dy-\int_{0}^{1}(\frac{1}{y}\frac{1}{3}y^3)dy)}}$\\
		${E[Y] = \mathlarger{-4(\ln(y)\frac{1}{3}y^3-\frac{1}{9}y^3)\big|_{0}^{1}} = \frac{4}{9}}$

	\end{enumerate}
	\item 
	\begin{enumerate}
		\item
		\myansw
		\colorbox{yellow}{${P\{X_1 + X_2 \geq 5000\} = P\{\frac{X_1+X_2 - 2200 \times 2}{\sqrt{52900 \times 2}} \geq \frac{5000 - 2200 \times 2}{\sqrt{52900 \times 2}} \}
		=1-\Phi (1.84) = 0.033}$}\\
		To be more accurate, we should use ${> 4999.5}$ instead of ${\geq 5000}$. The result in this particular case has no significant difference.
		\item
		\mysolu
		${P\{X \geq 2000  \} = 1 - \Phi(\frac{2000 - 2200}{\sqrt{52900}})=  \Phi(0.87) = 0.808}$\\
		\myansw
		The probability that the weekly number of visitors exceeds 2000 in at least 2 of the next 3 weeks is\\
		\colorbox{yellow}{${{3 \choose 2}p^2(p-1)+{3 \choose 1}p^3}=0.904$}\\
	\end{enumerate}
	\item
	\begin{enumerate}
		\item
		\myansw
		\colorbox{yellow}{${A \sim N(\mu_1+\mu_2, \sigma_1^2+\sigma_2^2)}$}\\
		\item
		\myansw
		\colorbox{yellow}{${B \sim N(5\mu_1+2, 25\sigma_1^2)}$}\\
		\item 
		\mysolu
		${C_a = aX}$\\
		${C_b = -bY}$\\
		${C_c = c^2Z}$\\
		${C_a \sim N(a\mu_1, a^2\sigma_1^2)}$\\
		${C_b \sim N(-b\mu_1, b^2\sigma_2^2)}$\\
		${C_c \sim N(c^2\mu_1, c^4\sigma_3^2)}$\\
		\myansw
		\colorbox{yellow}{${C \sim N(a\mu_1 - b\mu_2 + c^2\mu_3, a^2\sigma_1^2+b^2\sigma_2^2+c^4\sigma_3^2)}$}\\
		
	\end{enumerate}
	\item
	\begin{enumerate}
		\item
		\myansw
		\colorbox{yellow}{${\mathlarger{f_{XY}(x,y) = \left\lbrace \begin{array}{rcl}\frac{1}{6} \frac{1}{x} & & x, y  \in \{1,2,3,4,5,6\}\\
					0 & & x,y \notin \{1,2,3,4,5,6\}\\
					\end{array}\right.}}$}\\
		\item
		\myansw
		\colorbox{yellow}{${\mathlarger{P(X = j|Y = i) = \left\lbrace \begin{array}{rcl}\frac{1}{6} \frac{1}{j} & & i \leq j\\
					0 & & i > j\\
					\end{array}\right.}}$}\\
		\item
		\mysolu
		${f_X(x) = \left\lbrace \begin{array}{rcl}\frac{1}{6} & & x \in \{1,2,3,4,5,6\}\\
			0 & & x\notin \{1,2,3,4,5,6\}\\
			\end{array}\right.}$\\
		${f_Y(y) = \left\lbrace \begin{array}{rcl}\frac{1}{6}\sum\limits_{i = y}^6 \frac{1}{y} & & y \in \{1,2,3,4,5,6\}\\
			0 & & x\notin \{1,2,3,4,5,6\}\\
			\end{array}\right.}$\\
		${f_{XY}(x,y) \neq f_X(x)f_Y(y)}$\\
		\myansw
		\colorbox{yellow}{X and Y are NOT independent}\\	
		
	\end{enumerate}
	\item
	\mysolu
	Since the expectation of the distance are symmetrical when the package is dropped off in the 4 different quadrants. Let D' = the distance the robot travels to get to the package in first quadrants.\\
	${f_D'(d) = \frac{1}{4}(\frac{1}{5})^2}$\\
	${E[D']=\mathlarger{\frac{1}{100}\int_{0}^{5} \int_{0}^{5} (x+y) dxdy=\frac{1}{100}\int_{0}^{5} \frac{25}{2}+5ydy=\frac{125}{100}}}$\\
	\myansw
	${E[D] = 4E[D'] = 4 \frac{125}{100} = 5}$\\
	\item
	\mysolu
	The probability that "max update" is executed in each loop ${p_i =P(E_i)= 2^i}$, because the probability that the current number is higher than each of the previous numbers are all equal to ${\frac{1}{2}}$\\
	Let\\
	${I_i = \left\lbrace \begin{array}{rcl}1 & & E_i \text{ occurs}\\
		0 & &  \text{otherwise}\\
		\end{array}\right.}$\\
	\myansw
	The expected number of times that "max update" is executed is\\
	\colorbox{yellow}{${E[X] = \sum\limits_{i = 0}^{n-1}E[I_i] = \sum\limits_{i = 0}^{n-1}p_i = 2 - (\frac{1}{2})^{n-1}}$}
	
	\item
	\begin{enumerate}
		\item
		\mysolu
		${E[X] = \frac{a}{a+b} = 0.5}$\\
		${Var[X] =\frac{ab}{(a+b)^2(a+b+1)}}$\\
		\myansw
		\colorbox{yellow}{${a = b = 4}$}\\
		\item
		\mysolu
		${\text{X}|\text{13 flips resulting in 8 heads and 5 tails} \sim Beta(4+8, 4+5)}$\\
		\myansw
		\colorbox{yellow}{
			${\mathlarger{f(x) = \left\lbrace \begin{array}{rcl} \frac{1}{B(12,9)}x^{11}(1-x)^{8} & & \text{if} 0<x<1\\
				0 & & \text{otherwise}\\
				\end{array}\right.}}$
		}\\
		\item
		\mysolu
		${a' = 4 + 8 = 12}$\\
		${b' = 4 + 4 = 8}$\\
		\myansw
		\colorbox{yellow}{${E[X|\text{12 flips resulting in 8 heads and 4 tails}] = \frac{a}{a+b} = 0.6}$}\\
		\item
		\myansw
		\colorbox{yellow}{${Var(X|\text{12 flips resulting in 8 heads and 4 tails}) = \frac{ab}{(a+b)^2(a+b+1)}=}$}\\
		
	\end{enumerate}
	\item
	\mysolu
	By post processing the 2 data file we can find\\
	For randomFlips1.txt\\
	${P_1\{\text{Flip = Head}\} = 0.49 }$\\
	${P_1\{\text{Flip = Tail}\} = 0.51 }$\\
	${P_1\{\text{Flip = Tail|previous flip = head}\} = 0.694 }$\\
	${P_1\{\text{Flip = Tail|previous flip = Tail}\} = 0.329 }$\\
	${P_1\{\text{Flip = Head|previous flip = head}\} = 0.306 }$\\
	${P_1\{\text{Flip = Head|previous flip = Tail}\} = 0.671 }$\\

	From the previous results, we can find that the flips are not independent to the previous flip result.\\
	For example\\
	Let\\
	$P_1(H') = P_1\{\text{previous flip = head}\}$\\
	$P_1(HH') = P_1(H|H')P(H') = 0.306 \times 0.49 = 0.15$\\
	$P(H)p(H') = 0.51 \times 0.51 = 0.26  \neq P(HH')$\\
	For randomFlips2.txt\\
	${P\{\text{Flip = Head}\} = 0.503 }$\\
	${P\{\text{Flip = Tail}\} = 0.497 }$\\
	${P\{\text{Flip = Tail|previous flip = head}\} = 0.51 }$\\
	${P\{\text{Flip = Tail|previous flip = Tail}\} = 0.5 }$\\
	${P\{\text{Flip = Head|previous flip = head}\} = 0.49 }$\\
	${P\{\text{Flip = Head|previous flip = Tail}\} = 0.5 }$\\
	For the 2nd file, we can find that the flips are independent to the previous flip result.\\
	\myansw
	\colorbox{yellow}{Sequence 2 is a better random generator, because of the independence between flip results in row.}\\
	
	\item
	\begin{enumerate}
		\item
		\myansw
		\colorbox{yellow}{${E[X] = 7.41}$}\\
		\colorbox{yellow}{${E[Y] = 8.03}$}\\
		\item
		\myansw
		\colorbox{yellow}{${E[X^2] = 58.84}$}\\
		\colorbox{yellow}{${E[Y^2] = 68.17}$}\\	
		\item
		\mysolu
		${\mu_A = 7.41}$,	${\sigma_A^2 = E[X^2] - E[X]^2 =  3.98}$\\
		${\mu_B = 8.03}$,	${\sigma_B^2 = E[Y^2] - E[Y]^2 = 3.68}$\\
		\myansw
		\colorbox{yellow}{${X \sim N(7.41, 3.98)}$}\\
		\colorbox{yellow}{${Y \sim N(8.03, 3.68)}$}\\
		\item
		\mysolu
		Given writer is A, for each keystroke in email, the probability that the duration equals to the timing information is
		${P(X_i = x_i|A) =P(E_i|A)= \frac{1}{\sqrt{2\pi}\sigma_A}e^{-(x_i - \mu_A)^2/2\sigma_A^2}\epsilon}$ \\
		${\ln(P(E_i|A)) = \ln(\frac{\epsilon}{\sqrt{2\pi}\sigma_A})-(x_i - \mu_A)^2/2\sigma_A^2}$\\
		So, the probability that the email is written given writer is A is\\
		${\ln(P(E|A)) = \ln(\prod\limits_{i = 1}^{n}P(E_i|A)= \sum\limits_{i = 1}^{n}\ln(P(E_i|A))}$\\
		${\ln(P(E|A)) = n\ln(\frac{\epsilon}{\sqrt{2\pi}\sigma_A}) - \sum\limits_{i = 1}^{n}(x_i - \mu_A)^2/2\sigma_A^2}$\\
		The probability that the email is written given writer is B is\\
		${\ln(P(E|B)) = n\ln(\frac{\epsilon}{\sqrt{2\pi}\sigma_B}) - \sum\limits_{i = 1}^{n}(x_i - \mu_A)^2/2\sigma_B^2}$\\
		
		The probability that the writer is A given the email has been written is\\
		${P(A|E) = \frac{P(AE)}{P(E)}=\frac{P(E|A)P(A)}{P(E)}}$\\
		The probability that the writer is B given the email has been written is\\
		${P(B|E) = \frac{P(E|B)P(B)}{P(E)}}$\\
		${\frac{P(A|E)}{P(B|E)} = \frac{0.5P(E|A)}{0.5P(E|B)} = \frac{P(E|A)}{P(E|B)}}$\\
		${\frac{P(A|E)}{P(B|E)} = e^{\ln(P(E|A))-\ln(P(E|B))}}$\\
		\myansw
		
		\colorbox{yellow}{${\frac{P(A|E)}{P(B|E)} = e^{-9.42} = 8.1 \times 10^{-5}}$}\\
		
	\end{enumerate}

	
	

	
	
	
	
	
\end{enumerate}


\newpage



\end{document}